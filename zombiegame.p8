pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--game--

function _init()
 ibullets()
 ienemies()
end

function _update()
 move_player()
 
 if btnp(❎) then
  shoot()
 end
 ubullets()
end

function _draw()
 cls()
 if btnp(❎) then
  spr(0,player.x,player.y)
  sp=17
 end
 if player.flipped then
  spr(player.sprite,player.x,player.y,1,1,true)
 else
  spr(player.sprite,player.x,player.y) 
 end
for e in all(enemies) do 
 if (e.sprite<8) then
 e.sprite+=0.2
else
 e.sprite=2
 end
 	spr(e.sprite,e.x,e.y)
 end
 dbullets()
end

function col(a,b)
 local a_top=a.y
 local a_right=a.x+7
 local a_bottom=a.y+7
 local a_left=a.x
 
 local b_top=b.y
 local b_right=b.x+7
 local b_bottom=b.y+7
 local b_left=b.x
 
 if a_top>b_bottom then return false end
 if b_top>a_bottom then return false end
 if a_left>b_right then return false end
 if b_left>a_right then return false end
 
 return true 
end
-->8
--bullets--

function ibullets()
 buls={}
end

function ubullets()
 for bul in all(buls) do
  --what does each bullet do
  bul.x+=bul.spd
  if bul.x > 128 then
   del(buls,bul)
  end
  for e in all(enemies) do
   if col(bul,e) then
    del(buls,bul)
    del(enemies,e)
   end
  end
 end
end

function dbullets()
 for bul in all(buls) do
  --how to draw each bullet
  spr(0,bul.x,bul.y)
 end
end

function shoot()
 --what happens when we fire
 newbul = {
  x=player.x,
  y=player.y,
  spd=5,
  dmg=100
 }
 add(buls,newbul)
end
-->8
--player--

player={
 x=8,
 y=8,
 sprite=1,
 hp=100,
 flipped=false,
 moving=false,
 animation={
 timer=0
 }
}

function move_player()
 player.moving=false

 if btn(⬅️) then
  player.x-=1
  player.flipped=true
  player.moving=true
  player.sprite=8
 end
 if btn(➡️) then
  player.x+=1
  player.flipped=false
  player.moving=true
  player.sprite=8
 end
 if btn(⬆️) then
  player.y-=1
  player.moving=true
  player.sprite=9
 end
 if btn(⬇️) then
  player.y+=1
  player.moving=true
  player.sprite=1
 end
end

function animate_player()
 if player.moving then
  player.anim.timer+=1
   if player.anim.timer>5 then  -- this value determines animation speed
    player.anim.timer=0
    player.sprite=(player.sprite+1)%2  -- alternate between 0 and 1
  end
 else
  player.anim.frame=player.sprite --resets to idle sprite when not moving
 end
end
-->8
--enemy--

enemies={}

function ienemies()
 for i=1,5 do
	 add(enemies,{
		 x=rnd(20+64),
		 y=rnd(20+64),
		 sprite=2,
		 hp=100,
		 damage=10,
		 flipped=false,
		 moving=false,
		 anim={
		  timer=0,
		  frame=0
		  
		 }
	 })
 end
end
-->8
--map--
__gfx__
00000000000000000000000008080080000808800000008000080080000000000000000000000000000888800000000000000000000000000000000000000000
00000000004440000033300000008008080008880080800800888808000000000044400000444000008888880000000000000000000000000000000000000000
00000000007f700000838000008888080008038800000800088888880000000000ff700000fff000088888880000000000000000000000000000000000000000
0000000000fff00000333000003880008006633806363388863633800636330000fff00000fff000863633880000000000000000000000000000000000000000
0000500000a110000066300000863088003666300066888888668888006600000011a00000111000886688880000000000000000000000000000000000000000
00000000001110000036600000366080006036000368380883683880036030000011100000111000836838880000000000000000000000000000000000000000
00000000001010000060300000603000000030080000800008808800000000000010100000101000088888880000000000000000000000000000000000000000
00000000000000000000000000000000000008000008008800080088000000000000000000000000088808800000000000000000000000000000000000000000
__gff__
0808010101010101080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000f00200d75019750130500d750167500d7500f55012750137500f7500f7500d7500f7500d5500d7500d750157501475012750165501775010550147501605019050145500d750167501675009550167501a750
001e00001a7501e77021770217702277022770227701a750127501175012730137301573016740167501b7601f7502577025770257702477024770237501c7501775017750177501775017770157701577015770
0000000004316221062010622065230543cb07240561ab2510a2412a2312a4213a5213a6113a5113a4118a5113a523fa7213a7313a522aa5224b522d0622ca7230a1324a2324a223da323da532f0733ea573a167
001000200000015170111700a17004170000000417000000051700000000000041700000000000041700000004170001700617007170041700000005170001700000006170041700000000160061700917011170
001000001b3001330000000083000730000000000000430005300000000000000000053000000000000000001c200000000000018100000000000004100000000410000000041000410004100041000000000000
000100003b6503a650386503665033650326502f6502c6502a650286502665025650246502265021650206501e6501e6501c6501b6501a650196501965018650166501565013650136501265011650106500f650
000000003660022000200001f0001e0001d0001c0001b0001b0001900016000160001600016000180001600016010170301805018060180501805018050190501b0601f060250702b07030070360702e0703f070
__music__
00 00014344

